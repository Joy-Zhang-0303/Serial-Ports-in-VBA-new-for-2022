Before starting, note that these functions are intended to be used on a local Windows PC installation of Microsoft Office only.
They cannot be used on a Non-Windows PC installation or on hosted Office versions such as Office 365, Outlook etc. 
Macros must be enabled and documents should be saved as type Macro-Enabled. 

An 'intermediate' or better level of VBA and serial comms knowledge is assumed. 

Functions were developed on Windows 10 (64-Bit) and Office Professional 2019 installation.
Usage with other Windows and Office versions is untested, follow testing steps below to check compatibility. 

Host PC should have a physical or virtual COM Port available for use. Change (1) below to another port if required. 
Testing requires a second device to be connected to a local COM Port.
Second device can be on a second COM Port on the same host PC.

1.  Download SERIAL_PORT_VBA.bas to a known location on your PC
2.  Open a new Office Application (Excel,Word,Access) document and enter the VBA Environment (Alt-F11)
3.  From VBA Environment, view the Project Explorer (Control-R)
4.  From the Project Explorer, right-hand click and select Import File.
5.  Import the file SERIAL_PORT_VBA.bas
6.  Check that a new module SERIAL_PORT_VBA is visible in the Modules folder. 
7.  Close and return to Office application (Alt-Q)
8.  IMPORTANT - save document as type Macro-Enabled.
9.  To test, another PC, terminal or similar device should be connected to a COM port on the host PC first. 
10. Re-enter the VBA Environment (Alt-F11)
11. Select the VBA Immediate Window (Control-G)
12. Enter the following commands in the Immediate Window :-
13.   ?debug_com_port(1)    
14a.  ?start_com_port(1) to use default COM port settings  - or - 
14b.  ?start_com_port(1,"Baud=9600 Data=8") to specify COM port settings
15. Check that debug information is shown and the last line indicates SUCCESS
16. Send some text to your device and check that it is received correctly, e.g. 
17.  ?transmit_com_port(1,"Hello Device")
18. On your device, send some text back - e.g Hello Excel 123
19. Check that text is received
20.  ?receive_com_port(1)
19. Assign some text to a variable in the Immediate Window
21.  Y = "HELLO DEVICE 123"
22. Send variable to device and check that it is received
23.  ?send_com_port(1,Y)
24. On your device, send more data - e.g. QWERTY 
25. Receive data to a variable 
26.  Z = receive_com_port(1)
27. Check variable received correctly
28.  ?Z
29. Optional - explore other functions, e.g.
30.  ?wait_com_port(1)
31.  ?check_com_port(1)
32.  ?put_com_port(1,"A")
33.  ?get_com_port(1)
34. Close the com port
35.  ?stop_com_port(1)

Functions can be incorporated into your own VBA programs, and where appropriate can also be used directly in Excel worksheet Cells.
